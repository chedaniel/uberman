/*! Mitsubishi 05-09-2016 */

!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=d||{};d.Boot=function(a){},d.Boot.prototype={preload:function(){},create:function(){console.log("BOOT"),this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.stage.backgroundColor="#000",this.game.world.setBounds(0,0,4267,8192),this.game.state.start("Preloader")},update:function(){},render:function(){}},b.exports=d.Boot},{}],2:[function(a,b,c){var d=d||{};Hero=a("./prefabs/Hero"),DayCycle=a("./prefabs/DayCycle"),Car=a("./prefabs/Car"),Hud=a("./prefabs/Hud"),d.Game=function(a){},d.Game.prototype={preload:function(){},create:function(){console.log("GAME"),dayCycle=new DayCycle(this.game,3e5);var a=(this.game.add.bitmapData(this.game.world.width,this.game.world.height),this.game.add.bitmapData(this.game.world.width,this.game.world.height)),b=a.context.createLinearGradient(0,0,0,this.game.world.height);b.addColorStop(0,"black"),b.addColorStop(1,"#85b5e1"),a.context.fillStyle=b,a.context.fillRect(0,0,this.game.world.width,this.game.world.height),b=a.context.createLinearGradient(0,580,0,this.game.world.height),b.addColorStop(0,"black"),b.addColorStop(1,"#85b5e1"),a.context.fillStyle=b,a.context.fillRect(0,this.game.world.height,this.game.world.width,20);var c=this.game.add.sprite(0,0,a);platforms=this.game.add.group(),platforms.enableBody=!0;var d=platforms.create(0,this.game.world.height-209,"ground");d.scale.setTo(2,2),this.game.physics.enable(d),d.body.immovable=!0,sunSprite=this.game.add.sprite(this.game.world.width-this.game.world.width/2,this.game.world.height/2,"sun"),moonSprite=this.game.add.sprite(this.game.world.width-this.game.world.width/2,this.game.world.height,"moon"),orbit=this.game.add.sprite(this.game.world.centerX-2133.5,1835,"orbit"),fade=this.game.add.sprite(this.game.world.centerX-2133.5,this.game.world.height-3e3,"city_fade"),back=this.game.add.sprite(this.game.world.centerX-2133.5,this.game.world.height-2100,"city_background"),fore=this.game.add.sprite(this.game.world.centerX-2133.5,this.game.world.height-2133,"city_foreground");var e=[{sprite:c,from:2042407,to:11722184},{sprite:fade,from:2042407,to:11722184},{sprite:back,from:2042407,to:11722184},{sprite:fore,from:3096635,to:9882811}];dayCycle.initShading(e),dayCycle.initSun(sunSprite),dayCycle.initMoon(moonSprite),this.game.player=new Hero(this.game,this.game.world.centerX,this.game.world.height-260,this.game.world.height/2),this.game.door=this.game.add.sprite(3785,7942,"door"),this.game.physics.arcade.enable(this.game.door),this.game.door.anchor.setTo(.5,.5),this.game.add.existing(this.game.player),this.car=new Car(this.game,this.game.world.x-300,this.game.world.height-180,"car","RIGHT"),this.car4=new Car(this.game,this.game.world.x-300,this.game.world.height-180,"car2","RIGHT"),this.car2=new Car(this.game,this.game.world.width+270,this.game.world.height-120,"car2","LEFT"),this.car3=new Car(this.game,this.game.world.width+270,this.game.world.height-120,"car","LEFT"),this.game.add.existing(this.car),this.game.add.existing(this.car4),this.game.add.existing(this.car2),this.game.add.existing(this.car3),this.game.health=new Hud(this.game),this.game.add.existing(this.game.health),cursors=this.game.input.keyboard.createCursorKeys()},update:function(){this.game.physics.arcade.collide(this.game.player,platforms)},render:function(){}},b.exports=d.Game},{"./prefabs/Car":5,"./prefabs/DayCycle":6,"./prefabs/Hero":7,"./prefabs/Hud":8}],3:[function(a,b,c){var d=d||{};d.Preloader=function(a){},d.Preloader.prototype={preload:function(){this.game.load.bitmapFont("font","font/font.png","font/font.xml"),this.game.load.bitmapFont("smallfont","font/small_font.png","font/small_font.xml"),this.game.load.image("door","images/door.gif",70,80),this.game.load.image("orbit","images/orbit.png",4267,894),this.game.load.image("ground","images/ground.gif",4267,10),this.game.load.image("city_foreground","images/city_foreground.gif",4267,2133),this.game.load.image("city_background","images/city_background.gif",4267,2133),this.game.load.image("city_fade","images/city_fade_background.gif",4267,2133),this.game.load.image("cape_streak","images/cape_streak.png"),this.game.load.image("sun","images/sun.png"),this.game.load.image("moon","images/moon.png"),this.game.load.spritesheet("hero","images/uber_sprite.gif",55,110,17),this.game.load.image("car","images/car.gif",300,95),this.game.load.image("car2","images/car2.gif",270,81),this.game.load.image("uber_disk","images/UBER_DISK.png",138,138),this.game.load.image("alter_disk","images/ALTER_DISK.png",138,138)},create:function(){console.log("PRELOADER"),this.game.state.start("Game")},update:function(){},render:function(){}},b.exports=d.Preloader},{}],4:[function(a,b,c){Boot=a("./Boot"),Preloader=a("./Preloader"),Game=a("./Game");var d={width:window.innerWidth,height:window.innerHeight};!function(a){var b=new Phaser.Game(a.width,a.height,Phaser.AUTO,"");b.state.add("Boot",Boot),b.state.add("Preloader",Preloader),b.state.add("Game",Game),b.state.start("Boot")}(d)},{"./Boot":1,"./Game":2,"./Preloader":3}],5:[function(a,b,c){Car=function(a,b,c,d,e){Phaser.Sprite.call(this,a,b,c,d,0),this.direction=e,this.game.physics.enable(this,Phaser.Physics.ARCADE),this.car_tween=this.game.add.tween(this),this.driveby=this.game.add.audio("driveby"),this.start(),this.loaded=!1},Car.prototype=Object.create(Phaser.Sprite.prototype),Car.prototype.constructor=Car,Car.prototype.start=function(){var a;"LEFT"==this.direction?(a=this.game.world.x-this.width,this.scale.x=-1):(a=this.game.world.width+this.width,this.scale.x=1),this.car_tween.to({x:a},6e3).loop(!0),this.car_tween.delay(this.game.rnd.integerInRange(100,1e4)),this.car_tween.start(),this.loaded=!0},Car.prototype.update=function(){this.loaded},b.exports=Car},{}],6:[function(a,b,c){DayCycle=function(a,b){this.game=a,this.dayLength=b,this.shading=!1,this.sunSprite=!1,this.moonSprite=!1},DayCycle.prototype=Object.create(Phaser.Sprite.prototype),DayCycle.prototype.constructor=DayCycle,DayCycle.prototype.initSun=function(a){this.sunSprite=a,this.sunset(a)},DayCycle.prototype.initMoon=function(a){this.moonSprite=a,this.moonrise(a)},DayCycle.prototype.initShading=function(a){this.shading=a},DayCycle.prototype.sunrise=function(a){if(a.position.x=this.game.width-this.game.width/4,this.sunTween=this.game.add.tween(a).to({y:-250},this.dayLength,null,!0),this.sunTween.onComplete.add(this.sunset,this),this.shading){var b=this;this.shading.forEach(function(a){b.tweenTint(a.sprite,a.from,a.to,b.dayLength)})}},DayCycle.prototype.sunset=function(a){if(a.position.x=50,this.sunTween=this.game.add.tween(a).to({y:this.game.world.height},this.dayLength,null,!0),this.sunTween.onComplete.add(this.sunrise,this),this.shading){var b=this;this.shading.forEach(function(a){b.tweenTint(a.sprite,a.to,a.from,b.dayLength)})}},DayCycle.prototype.moonrise=function(a){a.position.x=this.game.width-this.game.width/4,this.moonTween=this.game.add.tween(a).to({y:-350},this.dayLength,null,!0),this.moonTween.onComplete.add(this.moonset,this)},DayCycle.prototype.moonset=function(a){a.position.x=50,this.moonTween=this.game.add.tween(a).to({y:this.game.world.height},this.dayLength,null,!0),this.moonTween.onComplete.add(this.moonrise,this)},DayCycle.prototype.tweenTint=function(a,b,c,d){var e={step:0};this.game.add.tween(e).to({step:100},d,Phaser.Easing.Default,!1).onUpdateCallback(function(){a.tint=Phaser.Color.interpolateColor(b,c,100,e.step,1)}).start()},b.exports=DayCycle},{}],7:[function(a,b,c){Hero=function(a,b,c,d){Phaser.Sprite.call(this,a,b,c,"hero",d),this.originHeight=this.game.world.height,this.isZooming=!1,this.frame=0,this.currentState="uber",this.isClicked=!1,this.sprite_message="",this.pointerHover=!1,this.inputEnabled=!0,this.events.onInputDown.add(this.onSpriteClick,this),this.events.onInputOver.add(this.onSpriteHover,this),this.events.onInputOut.add(this.onSpriteBlur,this),this.zoom_in_on=[],this.followedObject=this.body,this.game.physics.arcade.enable(this),this.directions=["LEFT","UP_LEFT","UP","UP_RIGHT","RIGHT","DOWN_RIGHT","DOWN","DOWN_LEFT"],this.alter_walk=this.animations.add("alter_up",[5],6,!1),this.alter_walk=this.animations.add("alter_fall",[5,6,7,8,9,10],6,!1),this.alter_walk=this.animations.add("alter_walk",[5,6,7,8,9,10],6,!1),this.alter_walk=this.animations.add("alter_stand",[5],6,!1),this.alter_walk=this.animations.add("uber_stand",[0],6,!1),this.alter_walk=this.animations.add("uber_walk",[11,12,13,14,15],6,!1),this.alter_walk=this.animations.add("fly_side",[3,4],6,!1),this.alter_walk=this.animations.add("fly_up",[1,2],6,!0),this.alter_walk=this.animations.add("take_off",[16],6,!0),this.alter_walk=this.animations.add("fly_up_diagonal",[3,4],6,!0),this.alter_walk=this.animations.add("fly_down_diagonal",[3,4],6,!0),this.body.gravity.y=300,this.body.collideWorldBounds=!0,this.body.fixedRotation=!0,this.anchor.setTo(.5,.5),this.game.camera.follow(this,Phaser.Camera.FOLLOW_LOCKON,.1,.1)},Hero.prototype=Object.create(Phaser.Sprite.prototype),Hero.prototype.constructor=Hero,Hero.prototype.spriteMessage=function(a,b){if(console.log("CALLED SPRITE MESSAGE"),console.log(a),!this.game.input.activePointer.isDown){this.sprite_message=this.game.add.bitmapText(a.x-2*a.body.width,a.y-a.body.height/2,"smallfont",b,18);this.game.add.tween(this.sprite_message).to({y:a.y-a.body.height/2-10},200,"Linear",!0,-1,-1,!0).loop(!0)}},Hero.prototype.onSpriteHover=function(a,b){if(this.pointerHover=!0,this.checkOverlap(this,this.game.door))this.onDoorHover();else{var c;c="uber"==this.currentState?"[click] Change into Secret Identity!":"[click] Change into Uberman!",this.body.touching.down&&this.spriteMessage(this,c)}},Hero.prototype.onSpriteBlur=function(a,b){this.sprite_message&&this.sprite_message.destroy(),this.pointerHover=!1},Hero.prototype.onDoorClick=function(a){console.log("DOOR CLICKED"),this.zoom_in_on=[a.x,a.y],this.followedObject=a},Hero.prototype.onDoorHover=function(){var a;a="uber"==this.currentState?"[click] Change before entering!":"[click] Enter Daily Planet!",this.spriteMessage(this.game.door,a)},Hero.prototype.onDoorBlur=function(){},Hero.prototype.switch_char=function(a){a.body.touching.down&&(console.log("ON GROUND"),"uber"==a.currentState?(console.log("GOING CLARK"),a.currentState="alter",a.angle=0,a.animations.play("alter_stand")):(console.log("GOING UBER"),a.currentState="uber",a.animations.play("uber_stand")))},Hero.prototype.onSpriteClick=function(a,b){this.sprite_message&&this.sprite_message.destroy(),this.checkOverlap(this,this.game.door)?"uber"!=this.currentState&&this.checkOverlap(this,this.game.door)?this.onDoorClick(this.game.door):(console.log("SWITCHING"),this.switch_char(a)):this.switch_char(a)},Hero.prototype.checkOverlap=function(a,b){var c=a.getBounds(),d=b.getBounds();return Phaser.Rectangle.intersects(c,d)},Hero.prototype.onSpriteRelease=function(a,b){this.isClicked=!1},Hero.prototype.getCardinal=function(a,b){return b?(a=Math.round((a+Math.PI)/(2*Math.PI)*8)%8,this.directions[a]):(a=Math.round((a+Math.PI)/(2*Math.PI)*4)%4,this.directions[2*a])},Hero.prototype.alter_movement=function(a){a&&(this.body.velocity.y=0),this.angle=0,this.body.allowRotation=!1;var b=this.game.input.activePointer;a&&(back.x-=.001*this.body.velocity.x,b.worldX>this.x&&(this.scale.x=1,this.animations.play("alter_walk")),b.worldX<this.x&&(this.scale.x=-1,this.animations.play("alter_walk")),this.game.physics.arcade.moveToXY(this,b.worldX,this.y,225))},Hero.prototype.uber_movement=function(a){var b=this.game.physics.arcade.moveToPointer(this,60,this.game.input.activePointer,500),c=this.getCardinal(b,!0);switch(back.x-=.001*this.body.velocity.x,fade.x-=5e-4*this.body.velocity.x,a||(back.y-=.001*this.body.velocity.y,fade.y-=5e-4*this.body.velocity.y),c){case"UP":this.angle=0,a?this.animations.play("take_off"):this.animations.play("fly_up");break;case"DOWN":this.angle=0,a?this.animations.play("uber_stand"):this.animations.play("fly_up");break;case"UP_LEFT":this.scale.x=-1,a?this.animations.play("take_off"):(this.angle=-45,this.animations.play("fly_up_diagonal"));break;case"UP_RIGHT":this.scale.x=1,a?this.animations.play("take_off"):(this.angle=45,this.animations.play("fly_up_diagonal"));break;case"RIGHT":this.scale.x=1,a?(this.angle=0,this.animations.play("uber_walk")):(this.angle=90,this.animations.play("fly_side"));break;case"DOWN_RIGHT":this.scale.x=1,a?(this.angle=0,this.animations.play("uber_walk")):(this.angle=135,this.animations.play("fly_down_diagonal"));break;case"DOWN_LEFT":this.scale.x=-1,a?(this.angle=0,this.animations.play("uber_walk")):(this.angle=-135,this.animations.play("fly_down_diagonal"));break;case"LEFT":this.scale.x=-1,a?(this.angle=0,this.animations.play("uber_walk")):(this.angle=-90,this.animations.play("fly_side"))}},Hero.prototype.isMoving=function(){return Phaser.Point.equals(this.body.velocity,new Phaser.Point(0,0))},Hero.prototype.update=function(){var a,b=this.body.touching.down;this.isZooming||(this.game.input.activePointer.isDown&&(this.pointerHover||("uber"==this.currentState?this.uber_movement(b):this.alter_movement(b))),this.game.input.activePointer.justReleased(1)||this.game.input.activePointer.isDown||(this.angle=0,this.body.velocity.set(0),a=null,"uber"==this.currentState?(this.animations.play("fly_up"),b&&this.animations.play("uber_stand")):this.animations.stop()))},Hero.prototype.render=function(){this.game.debug.text(direction||"--",2,14,"#0f0")},b.exports=Hero},{}],8:[function(a,b,c){HUD=function(a,b,c){this.player=a.player,this.bar=a.add.bitmapData(128,20),Phaser.Sprite.call(this,a,0,0,this.bar),this.fixedToCamera=!0,this.cameraOffset.setTo(162,100),this.damage=0,this.uber_disk=this.game.add.sprite(0,0,"uber_disk"),this.uber_disk.anchor.setTo(.5,.5),this.uber_disk.fixedToCamera=!0,this.uber_disk.cameraOffset.setTo(89,89),this.alter_disk=this.game.add.sprite(0,0,"alter_disk"),this.alter_disk.anchor.setTo(.5,.5),this.alter_disk.fixedToCamera=!0,this.alter_disk.cameraOffset.setTo(89,89),this.barProgress=128},HUD.prototype=Object.create(Phaser.Sprite.prototype),HUD.prototype.constructor=HUD,HUD.prototype.preload=function(){this.game.time.advancedTiming=!0},HUD.prototype.switchState=function(){"uber"==this.player.currentState&&(console.log("SCALE:",this.uber_disk.scale,this.uber_disk.alpha,this.uber_disk.x),this.game.add.tween(this.alter_disk.scale).to({x:0,y:0},30,Phaser.Easing.Bounce.InOut,!0),this.game.add.tween(this.uber_disk.scale).to({x:1,y:1},30,Phaser.Easing.Bounce.InOut,!0),this.uber_disk.bringToTop()),"alter"==this.player.currentState&&(this.game.add.tween(this.uber_disk.scale).to({x:0,y:0},30,Phaser.Easing.Bounce.InOut,!0),this.game.add.tween(this.alter_disk.scale).to({x:1,y:1},30,Phaser.Easing.Bounce.InOut,!0),this.alter_disk.bringToTop())},HUD.prototype.create=function(){this.game.add.sprite(0,0,this.bar)},HUD.prototype.animateDamage=function(){this.damage>0&&(this.game.add.tween(this).to({barProgress:this.barProgress-this.damage},200,"Linear",!0),this.damage=0)},HUD.prototype.update=function(){this.switchState(),this.bar.context.clearRect(0,0,this.bar.width,this.bar.height),this.barProgress<32?this.bar.context.fillStyle="#f00":this.barProgress<64?this.bar.context.fillStyle="#ff0":this.bar.context.fillStyle="#0f0",this.bar.context.fillRect(0,0,this.barProgress,20),this.bar.dirty=!0,this.animateDamage()},b.exports=HUD},{}]},{},[4]);
//# sourceMappingURL=bundle.min.js.map